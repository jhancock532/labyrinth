<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <!--All this code is copy pasted by hand.-->

  <title>entrance.html</title>
  <meta name="description" content="The way in.">

  <style>
  canvas {
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    margin: 0;
    z-index: -1;
  }
  </style>
</head>

<body>
  <script src="js/p5.min.js"></script>
  <script src="js/p5.sound.min.js"></script>
  <script src="js/dat.gui.min.js"></script>

  <script>
  //// ---- DAT.GUI CODE ---- ////
  let params = { 
    circleStartSize: 1600, //works well for 2K fullscreen devices. Set this dynamically to cover screen on mouseClick? //Done
    animationSpeed: 4, //This is also set dynamically on mouseclick.
    animationSpeedDivisor: 200, //Smaller is faster.
    reset: function(){
      framesAnimated = 0;
      schwooping = false;
      background("white");
      cursor("pointer");
    },
    startFrequency: 1000,
    endFrequency: 150,
    amplitude: 0.1, //ramp up this amplitude as the circle gets smaller? Hard to hear the lower frequencies.
  }

  //What if leaving comments in the source code is the documentation for this art project?
  //That makes a lot of sense.

  let gui = new dat.GUI();
  dat.GUI.toggleHide();
  //Using dat.gui I can tweak to get the right feel quickly.

  let circleFolder = gui.addFolder("Circle");
  circleFolder.add(params, "animationSpeedDivisor", 1, 1000).name("Speed");

  let soundFolder = gui.addFolder("Sound");
  soundFolder.add(params, "startFrequency", 0, 2000).name("Start Freq.");
  soundFolder.add(params, "endFrequency", 0, 2000).name("End Freq.");
  soundFolder.add(params, "amplitude", 0, 1).name("Volume");

  gui.add(params, "reset").name("Reset");

  //// ---- P5JS CODE ---- ////
  // - Documentation - https://p5js.org/reference/

  //Developing using p5.js, not having a clear goal beyond the exploration of one and zero
  //The most important thing I learned yesterday was to focus on what I enjoy
  //This is going to be awesome.

  let schwooping = false;
  let framesAnimated = 0;

  let osc;

  function setup(){
    createCanvas(windowWidth, windowHeight); 
    colorMode(HSB, 360, 100, 100, 1); 
    frameRate(60);
    
    cursor("pointer"); 
    
    //cursor - pointer ... The fundamental indicator of user interaction.
    //Deciding which cursor to display is very important.
    //Being greeted with a white screen, just seeing the pointer...
    //We're reminded of the internet context, the fundamentals of how we interact with this world.
    //We so easily take the cursor for granted. Cursor mindfulness practice anyone? Cursor roulette?
    
    osc = new p5.Oscillator('sine');
  }

  function windowResized() {
    resizeCanvas(windowWidth, windowHeight);
  }

  function mousePressed(){
    if (framesAnimated == 0){
      background(0, 0, 0, 1);
      setCircleParameters(); //size and speed
      schwooping = true;
      
      cursor(AUTO);
      
      osc.start();
      osc.freq(params.startFrequency, 0); //The lower frequencies hit the heart in a raw and direct manner.
      osc.amp(params.amplitude, 0);
    }
  }

  function setCircleParameters(){
    let topLeft = dist(mouseX, mouseY, 0, 0);
    let topRight = dist(mouseX, mouseY, windowWidth, 0);
    let bottomLeft = dist(mouseX, mouseY, 0, windowHeight);
    let bottomRight = dist(mouseX, mouseY, windowWidth, windowHeight);
    
    let startSize = max(topLeft, topRight, bottomRight, bottomLeft);
    
    params.circleStartSize = startSize * 2;
    
    params.animationSpeed = startSize / params.animationSpeedDivisor;
  }

  function draw(){
    
    //All this code is live for anyone to steal and interact with.
    //Art created entirely on the internet, one small piece at a time.
    //It doesn't really follow the conventional artist, who paints for months in private
    //It's going to be difficult working like this.
    //I'll be being judged by the anonymous eyes of the Internet! O.O
    //Scary.
    
    if (schwooping){
      background(0, 0, 0, 1);
      
      let size = params.circleStartSize - framesAnimated * params.animationSpeed;
      let frequency = lerp(params.startFrequency, params.endFrequency, 1 - size / params.circleStartSize);
      
      osc.freq(frequency, 0);
      ellipse(mouseX, mouseY, size, size);
      
      if (size < 0){
        schwooping = false;
        osc.amp(0, 0.5);
        osc.freq(0, 0.5);
        background(0, 0, 0, 1);

        window.location.href = "hallway.html";
      }
      
      framesAnimated += 1;
    }
  }
  </script>
</body>
</html>